%s\\\\\\hline
\\end{tabular}}\n\n \\framebreak \n"
,
c_step$input[1],candidates)
total_printing %<>% append(printing)
# set new winner no
winner_no <<- c_step$cand_no[which(c_step$winner)]
}
file_con <- file("./trial.txt")
writeLines(total_printing, file_con, sep = "\n")
close(file_con)
library(tidyverse)
library(magrittr)
df_der <- readRDS("basic_derivation.rds")
solution <- readRDS("basic_solution.rds")
df <- df_der %>% mutate(harmony = rowSums(sweep(.[,5:17], MARGIN = 2, solution, '*'))) %>%
mutate(winner = ifelse(freq == 1, T, F)) %>%
dplyr::select(cycle_number, operation, input, output, winner,
names(which(solution != 0)), harmony)
rm(df_der)
df %<>% group_by(cycle_number) %>% mutate(cand_no = 1:n()) %>% mutate(operation = str_replace(operation,"[:punct:]", " "))
winner_no <- "1"
total_printing <- character()
for (each in 1:length(unique(df$cycle_number))){
c_step <- df %>% subset(cycle_number == each)
full_table <- c_step %>% ungroup() %>% dplyr::select(winner, operation, lab, mc, case_agr, case_mt, copy, exnum, harmony) %>%
mutate(cand = sprintf("%s & %s & %s & %s & %s & %s & %s & %s & %s",
ifelse(winner, "\\HandRight",""),
operation,
lab, mc, case_agr, case_mt, copy, exnum, round(harmony)))
candidates <- paste(full_table$cand, collapse = "\\\\\\hline\n")
# modify output numbers
c_step$cand_no <- paste0(winner_no,".",c_step$cand_no)
printing <- sprintf(
"\\hbox{\\small\\begin{tabular}{|rl||c|c|c|c|c|c|c|}\\hline
\\multicolumn{2}{|l||}{I: \\hbox{\\tiny \\begin{forest} %s \\end{forest}}} & \\textsc{lab} & \\textsc{mc} & \\textsc{agr} & \\textsc{mt} & \\textsc{copy} & \\textsc{Exnum} & H\\\\\\hline
%s\\\\\\hline
\\end{tabular}}\n\n \\framebreak \n"
,
c_step$input[1],candidates)
total_printing %<>% append(printing)
# set new winner no
winner_no <<- c_step$cand_no[which(c_step$winner)]
}
file_con <- file("./trial.txt")
writeLines(total_printing, file_con, sep = "\n")
close(file_con)
library(tidyverse)
library(magrittr)
df_der <- readRDS("basic_derivation.rds")
solution <- readRDS("basic_solution.rds")
df <- df_der %>% mutate(harmony = rowSums(sweep(.[,5:17], MARGIN = 2, solution, '*'))) %>%
mutate(winner = ifelse(freq == 1, T, F)) %>%
dplyr::select(cycle_number, operation, input, output, winner,
names(which(solution != 0)), harmony)
rm(df_der)
df %<>% group_by(cycle_number) %>% mutate(cand_no = 1:n()) %>% mutate(operation = str_replace(operation,"[:punct:]", " "))
winner_no <- "1"
total_printing <- character()
for (each in 1:length(unique(df$cycle_number))){
c_step <- df %>% subset(cycle_number == each)
full_table <- c_step %>% ungroup() %>% dplyr::select(winner, operation, lab, mc, case_agr, case_mt, copy, exnum, harmony) %>%
mutate(cand = sprintf("%s & %s & %s & %s & %s & %s & %s & %s & %s",
ifelse(winner, "\\HandRight",""),
operation,
lab, mc, case_agr, case_mt, copy, exnum, round(harmony)))
candidates <- paste(full_table$cand, collapse = "\\\\\\hline\n")
# modify output numbers
c_step$cand_no <- paste0(winner_no,".",c_step$cand_no)
printing <- sprintf(
"\\hbox{\\small\\begin{tabular}{|rl||c|c|c|c|c|c|c|}\\hline
\\multicolumn{2}{|l||}{I: \\hbox{\\tiny \\begin{forest} %s \\end{forest}}} & \\textsc{lab} & \\textsc{mc} & \\textsc{agr} & \\textsc{mt} & \\textsc{copy} & \\textsc{Exnum} & H\\\\\\hline
%s\\\\\\hline
\\end{tabular}}\n\n \\framebreak \n"
,
c_step$input[1],candidates)
total_printing %<>% append(printing)
# set new winner no
winner_no <<- c_step$cand_no[which(c_step$winner)]
}
file_con <- file("./basic_derivation_tableaux.txt")
writeLines(total_printing, file_con, sep = "\n")
close(file_con)
library(tidyverse)
library(magrittr)
library(philentropy)
library(optimx)
library(data.tree)
source("./machinery2.0/updated_gen_functions.R")
source("./machinery2.0/updated_eval_functions.R")
source("./machinery2.0/updated_cyclic_operator.R")
source("./machinery2.0/updated_draw_latex.R")
source("./machinery2.0/weight_optimizer.R")
df <- read.csv("ewe_numeration.csv", na.strings = "NA") %>%
mutate(mc = ifelse(is.na(mc), "", mc))
library(tidyverse)
library(magrittr)
library(philentropy)
library(optimx)
library(data.tree)
source("./machinery2.0/updated_gen_functions.R")
source("./machinery2.0/updated_eval_functions.R")
source("./machinery2.0/updated_cyclic_operator.R")
source("./machinery2.0/updated_draw_latex.R")
source("./machinery2.0/weight_optimizer.R")
df <- read.csv("ewe_numeration.csv", na.strings = "NA") %>%
mutate(mc = ifelse(is.na(mc), "", mc))
dt_trial <- mergeMC("DP1","V", numeration = df)
df <- df[c(-1,-2),]
View(df)
winner_output <- 100
my_derivation <- tibble()
last_tree <- list()
last_numeration <- list()
count <- 0
v_phased <- 0
while(winner_output != 0){
if (winner_output == 100){
my_cycle <- cycle_step(dt_trial, df)
}else{
my_cycle <- cycle_step(my_cycle[[winner_output]]$tree, my_cycle[[winner_output]]$numeration)
}
current_eval <- prepare_tableau(my_cycle)
View(current_eval)
winner_output <- readline(prompt = "Winner output: ");
winner_output %<>% as.integer()
if(winner_output !=0){
count <- count+1
current_eval$cycle_number <- count
current_eval %<>% set_winner(winner_output)
my_derivation %<>% rbind(current_eval)
last_tree <- my_cycle[[winner_output]]$tree
last_numeration <- my_cycle[[winner_output]]$numeration}
}
while(winner_output != 0){
if (winner_output == 100){
my_cycle <- cycle_step(dt_trial, df)
}else{
my_cycle <- cycle_step(my_cycle[[winner_output]]$tree, my_cycle[[winner_output]]$numeration)
}
current_eval <- prepare_tableau(my_cycle)
View(current_eval)
winner_output <- readline(prompt = "Winner output: ");
winner_output %<>% as.integer()
if(winner_output !=0){
count <- count+1
current_eval$cycle_number <- count
current_eval %<>% set_winner(winner_output)
my_derivation %<>% rbind(current_eval)
last_tree <- my_cycle[[winner_output]]$tree
last_numeration <- my_cycle[[winner_output]]$numeration}
}
library(tidyverse)
library(magrittr)
library(philentropy)
library(optimx)
library(data.tree)
source("./machinery2.0/updated_gen_functions.R")
source("./machinery2.0/updated_eval_functions.R")
source("./machinery2.0/updated_cyclic_operator.R")
source("./machinery2.0/updated_draw_latex.R")
source("./machinery2.0/weight_optimizer.R")
df <- read.csv("ewe_numeration.csv", na.strings = "NA") %>%
mutate(mc = ifelse(is.na(mc), "", mc))
dt_trial <- mergeMC("DP1","V", numeration = df)
df <- df[c(-1,-2),]
winner_output <- 100
my_derivation <- tibble()
last_tree <- list()
last_numeration <- list()
count <- 0
v_phased <- 0
while(winner_output != 0){
if (winner_output == 100){
my_cycle <- cycle_step(dt_trial, df)
}else{
my_cycle <- cycle_step(my_cycle[[winner_output]]$tree, my_cycle[[winner_output]]$numeration)
}
current_eval <- prepare_tableau(my_cycle)
View(current_eval)
winner_output <- readline(prompt = "Winner output: ");
winner_output %<>% as.integer()
if(winner_output !=0){
count <- count+1
current_eval$cycle_number <- count
current_eval %<>% set_winner(winner_output)
my_derivation %<>% rbind(current_eval)
last_tree <- my_cycle[[winner_output]]$tree
last_numeration <- my_cycle[[winner_output]]$numeration}
}
library(tidyverse)
library(magrittr)
library(philentropy)
library(optimx)
library(data.tree)
source("./machinery2.0/updated_gen_functions.R")
source("./machinery2.0/updated_eval_functions.R")
source("./machinery2.0/updated_cyclic_operator.R")
source("./machinery2.0/updated_draw_latex.R")
source("./machinery2.0/weight_optimizer.R")
df <- read.csv("ewe_numeration.csv", na.strings = "NA") %>%
mutate(mc = ifelse(is.na(mc), "", mc))
dt_trial <- mergeMC("DP1","V", numeration = df)
df <- df[c(-1,-2),]
winner_output <- 100
my_derivation <- tibble()
last_tree <- list()
last_numeration <- list()
count <- 0
v_phased <- 0
while(winner_output != 0){
if (winner_output == 100){
my_cycle <- cycle_step(dt_trial, df)
}else{
my_cycle <- cycle_step(my_cycle[[winner_output]]$tree, my_cycle[[winner_output]]$numeration)
}
current_eval <- prepare_tableau(my_cycle)
View(current_eval)
winner_output <- readline(prompt = "Winner output: ");
winner_output %<>% as.integer()
if(winner_output !=0){
count <- count+1
current_eval$cycle_number <- count
current_eval %<>% set_winner(winner_output)
my_derivation %<>% rbind(current_eval)
last_tree <- my_cycle[[winner_output]]$tree
last_numeration <- my_cycle[[winner_output]]$numeration}
}
library(tidyverse)
library(magrittr)
library(philentropy)
library(optimx)
library(data.tree)
source("./machinery2.0/updated_gen_functions.R")
source("./machinery2.0/updated_eval_functions.R")
source("./machinery2.0/updated_cyclic_operator.R")
source("./machinery2.0/updated_draw_latex.R")
source("./machinery2.0/weight_optimizer.R")
df <- read.csv("basic_numeration.csv", na.strings = "NA") %>%
mutate(mc = ifelse(is.na(mc), "", mc))
dt_trial <- mergeMC("DP1","V", numeration = df)
df <- df[c(-1,-2),]
winner_output <- 100
my_derivation <- tibble()
last_tree <- list()
last_numeration <- list()
count <- 0
v_phased <- 0
while(winner_output != 0){
if (winner_output == 100){
my_cycle <- cycle_step(dt_trial, df)
}else{
my_cycle <- cycle_step(my_cycle[[winner_output]]$tree, my_cycle[[winner_output]]$numeration)
}
current_eval <- prepare_tableau(my_cycle)
View(current_eval)
winner_output <- readline(prompt = "Winner output: ");
winner_output %<>% as.integer()
if(winner_output !=0){
count <- count+1
current_eval$cycle_number <- count
current_eval %<>% set_winner(winner_output)
my_derivation %<>% rbind(current_eval)
last_tree <- my_cycle[[winner_output]]$tree
last_numeration <- my_cycle[[winner_output]]$numeration}
}
# fix repeating inputs
my_result <- dplyr::select(my_derivation, -operation, -cycle_number, frequency = freq)
my_result
View(my_result)
# fix repeating inputs
my_result <- dplyr::select(my_derivation, -operation, -cycle_number, frequency = freq)
optimized_der <- weight_optimize(my_result)
trial <- matrix(data = c(1,0,1,0,4,5,0,0,
1,0,1,0,0,7,0,0,
0,0,1,0,4,3,0,0,
0,0,0,0,4,3,1,0),
nrow = 4, ncol = 8)
trial
weights <- c(20,11,8,28,9,3,3,40)
trial %*% weights * -1
trial %*% weights
sweep(trial, MARGIN = 2, weights, "*")
trial <- matrix(data = c(1,0,1,0,4,5,0,0,
1,0,1,0,0,7,0,0,
0,0,1,0,4,3,0,0,
0,0,0,0,4,3,1,0),
nrow = 4, ncol = 8)
weights <- c(-20,-11,-8,-28,-9,-3,-3,-40)
trial2 <- sweep(trial, MARGIN = 2, weights, "*")
trial2
trial2 <- sweep(trial, MARGIN = 2, weights, "*") %>% rowSums()
trial2
trial2 <- sweep(trial, MARGIN = 2, weights, "*") %>% rowSums()
trial2 <- sweep(trial, MARGIN = 2, weights, "*") %>% rowSums() %>% exp()
trial2
trial <- matrix(data = c(1,0,1,0,4,5,0,0,
1,0,1,0,0,7,0,0,
0,0,1,0,4,3,0,0,
0,0,0,0,4,3,1,0),
nrow = 4, ncol = 8)
weights <- c(-20,-11,-8,-28,-9,-3,-3,-40)
sapply(trial, function(the_element) the_element %*% weights) %>%
sapply(function(the_element) exp(the_element)/sum(exp(the_element)))
sapply(trial, function(the_element) the_element[,1:8] %*% weights) %>%
sapply(function(the_element) exp(the_element)/sum(exp(the_element)))
sapply(trial, function(the_element) the_element[,1:8] %*% weights)
trial <- matrix(data = c(1,0,1,0,4,5,0,0,
1,0,1,0,0,7,0,0,
0,0,1,0,4,3,0,0,
0,0,0,0,4,3,1,0),
nrow = 4, ncol = 8)
weights <- c(-20,-11,-8,-28,-9,-3,-3,-40)
trial
trial2 <- sweep(trial, MARGIN = 2, weights, "*") %>% rowSums() %>% exp()
trial2 <- sweep(trial, MARGIN = 2, weights, "*") %>%
rowSums() %>% exp() %>% tibble(x = .)
View(trial2)
trial2 <- sweep(trial, MARGIN = 2, weights, "*") %>%
rowSums() %>% exp() %>% tibble(x = .) %>% mutate(x/sum(x))
View(trial2)
trial2$prob <- trial2 %>% mutate(x/sum(trial2$x))
View(trial2)
sum(trial2$x)
trial2 <- sweep(trial, MARGIN = 2, weights, "*") %>%
rowSums() %>% exp() %>% tibble(x = .) %>%
trial2$prob <- trial2$x/sum(trial2$x)
trial2 <- sweep(trial, MARGIN = 2, weights, "*") %>%
rowSums() %>% exp() %>% tibble(x = .)
trial2$prob <- trial2$x/sum(trial2$x)
trial2 <- sweep(trial, MARGIN = 2, weights, "*") %>%
rowSums() %>% exp() %>% tibble(x = .)
sum(trial2$x)
trial2$x
trial2$x
trial2$x/sum(trial2$x)
trial2$x[1]/sum(trial2$x)
trial2 <- sweep(trial, MARGIN = 2, weights, "*") %>%
rowSums()
?sapply
str(trial2)
str(trial)
trial2 <- sweep(trial, MARGIN = 2, weights, "*") %>%
rowSums() %>% exp()
my_result
my_tableaux <- my_result
# extract constraint names
constraints <- colnames(my_tableaux)[4:16]
constraints
# turn data frame into a list of matrices where each matrix is a single derivation
tableaux <- my_tableaux %>% split(.$input) %>% map(~ (.x %>% dplyr::select(-input,-output))) %>% lapply(as.matrix)
# frequencies of the candidates for each derivation
frequencies <- lapply(tableaux,function(x){x[,"frequency"]})
x <- weights
# calculate probabilities across the matrices in the list
probabilities <- sapply(tableaux, function(the_element) the_element[,constraints] %*% (x*-1)) %>% # calculate harmony values on negative terms
sapply(function(the_element) exp(the_element)/sum(exp(the_element))) %>% # calculate the probability of each candidate
lapply(function(x) {colnames(x) <- "probabilities"; x}) # rename the resulting column as probabilities
trial2 <- sweep(trial, MARGIN = 2, weights, "*") %>%
rowSums() %>% exp()
trial2$V1
trial2[,V1]
trial2
trial2[1]/sum(trial2)
trial <- matrix(data = c(1,0,1,0,4,5,0,0,
1,0,1,0,0,7,0,0,
0,0,1,0,4,3,0,0,
0,0,0,0,4,3,1,0),
nrow = 4, ncol = 8)
weights <- c(-20,-11,-8,-28,-9,-3,-3,-40)
trial2 <- sweep(trial, MARGIN = 2, weights, "*")
trial2 <- sweep(trial, MARGIN = 2, weights, "*") %>% rowSums()
trial2 <- sweep(trial, MARGIN = 2, weights, "*") %>% rowSums() %>% exp()
sum(trial2[1], trial2[2])
trial2[1] + trial2[2] + trial2[3] + trial2[4]
trial[1] / trial2[1] + trial2[2] + trial2[3] + trial2[4]
trial[1] / trial2[1] + trial2[2] + trial2[3] + trial2[4]
trial[2] / trial2[1] + trial2[2] + trial2[3] + trial2[4]
trial[3] / trial2[1] + trial2[2] + trial2[3] + trial2[4]
trial[4] / trial2[1] + trial2[2] + trial2[3] + trial2[4]
trial[1] / trial2[1] + trial2[2] + trial2[3] + trial2[4]
trial[2] / trial2[1] + trial2[2] + trial2[3] + trial2[4]
trial[3] / trial2[1] + trial2[2] + trial2[3] + trial2[4]
trial[4] / trial2[1] + trial2[2] + trial2[3] + trial2[4]
trial[1] / (trial2[1] + trial2[2] + trial2[3] + trial2[4])
trial[2] / (trial2[1] + trial2[2] + trial2[3] + trial2[4])
trial[3] / (trial2[1] + trial2[2] + trial2[3] + trial2[4])
trial[4] / (trial2[1] + trial2[2] + trial2[3] + trial2[4])
trial[1]
trial2[1]
trial2[1] / (trial2[1] + trial2[2] + trial2[3] + trial2[4])
trial2[2] / (trial2[1] + trial2[2] + trial2[3] + trial2[4])
trial2[3] / (trial2[1] + trial2[2] + trial2[3] + trial2[4])
trial2[4] / (trial2[1] + trial2[2] + trial2[3] + trial2[4])
trial <- matrix(data = c(1,0,1,0,4,5,0,0,
1,0,1,0,0,7,0,0,
0,0,1,0,4,3,0,0,
0,0,0,0,4,3,1,0),
nrow = 4, ncol = 8)
trial3 <- matrix(data = c(1,1,1,0,4,5,0,0,
1,0,1,0,0,7,0,0,
0,1,1,0,4,3,0,0,
0,1,0,0,4,3,1,0),
mrow= 4, ncol = 8)
weights <- c(-20,-11,-8,-28,-9,-3,-3,-40)
trial3p <- sweep(trial3, MARGIN = 2, weights, "*") %>% rowSums() %>% exp()
trial <- matrix(data = c(1,0,1,0,4,5,0,0,
1,0,1,0,0,7,0,0,
0,0,1,0,4,3,0,0,
0,0,0,0,4,3,1,0),
nrow = 4, ncol = 8)
trial3 <- matrix(data = c(1,1,1,0,4,5,0,0,
1,0,1,0,0,7,0,0,
0,1,1,0,4,3,0,0,
0,1,0,0,4,3,1,0),
mrow= 4, ncol = 8)
trial3 <- matrix(data = c(1,1,1,0,4,5,0,0,
1,0,1,0,0,7,0,0,
0,1,1,0,4,3,0,0,
0,1,0,0,4,3,1,0),
nrow= 4, ncol = 8)
weights <- c(-20,-11,-8,-28,-9,-3,-3,-40)
trial3p <- sweep(trial3, MARGIN = 2, weights, "*") %>% rowSums() %>% exp()
trial2 <- sweep(trial, MARGIN = 2, weights, "*") %>% rowSums() %>% exp()
trial2[1] / (trial2[1] + trial2[2] + trial2[3] + trial2[4])
trial2[2] / (trial2[1] + trial2[2] + trial2[3] + trial2[4])
trial2[3] / (trial2[1] + trial2[2] + trial2[3] + trial2[4])
trial2[4] / (trial2[1] + trial2[2] + trial2[3] + trial2[4])
trial3p[1] / (trial3p[1] + trial3p[2] + trial3p[3] + trial3p[4])
trial3p[2] / (trial3p[1] + trial3p[2] + trial3p[3] + trial3p[4])
trial3p[3] / (trial3p[1] + trial3p[2] + trial3p[3] + trial3p[4])
trial3p[4] / (trial3p[1] + trial3p[2] + trial3p[3] + trial3p[4])
trial3p <- sweep(trial3, MARGIN = 2, weights, "*") %>% rowSums()
trial3p
trial2
trial3p <- sweep(trial3, MARGIN = 2, weights, "*") %>% rowSums() %>% exp()
trial2 <- sweep(trial, MARGIN = 2, weights, "*") %>% rowSums() %>% exp()
trial3p
trial2
weights <- c(-20,-30,-8,-28,-9,-3,-3,-40)
trial3p <- sweep(trial3, MARGIN = 2, weights, "*") %>% rowSums() %>% exp()
trial2 <- sweep(trial, MARGIN = 2, weights, "*") %>% rowSums() %>% exp()
trial2[1] / (trial2[1] + trial2[2] + trial2[3] + trial2[4])
trial2[2] / (trial2[1] + trial2[2] + trial2[3] + trial2[4])
trial2[3] / (trial2[1] + trial2[2] + trial2[3] + trial2[4])
trial2[4] / (trial2[1] + trial2[2] + trial2[3] + trial2[4])
trial3p[1] / (trial3p[1] + trial3p[2] + trial3p[3] + trial3p[4])
trial3p[2] / (trial3p[1] + trial3p[2] + trial3p[3] + trial3p[4])
trial3p[3] / (trial3p[1] + trial3p[2] + trial3p[3] + trial3p[4])
trial3p[4] / (trial3p[1] + trial3p[2] + trial3p[3] + trial3p[4])
weights <- c(-20,-40,-8,-28,-9,-3,-3,-40)
trial3p <- sweep(trial3, MARGIN = 2, weights, "*") %>% rowSums() %>% exp()
trial2 <- sweep(trial, MARGIN = 2, weights, "*") %>% rowSums() %>% exp()
trial2[1] / (trial2[1] + trial2[2] + trial2[3] + trial2[4])
trial2[2] / (trial2[1] + trial2[2] + trial2[3] + trial2[4])
trial2[3] / (trial2[1] + trial2[2] + trial2[3] + trial2[4])
trial2[4] / (trial2[1] + trial2[2] + trial2[3] + trial2[4])
trial3p[1] / (trial3p[1] + trial3p[2] + trial3p[3] + trial3p[4])
trial3p[2] / (trial3p[1] + trial3p[2] + trial3p[3] + trial3p[4])
trial3p[3] / (trial3p[1] + trial3p[2] + trial3p[3] + trial3p[4])
trial3p[4] / (trial3p[1] + trial3p[2] + trial3p[3] + trial3p[4])
trial3p
trial2
trial <- matrix(data = c(1,0,1,0,4,5,0,0,
1,0,1,0,0,7,0,0,
0,0,1,0,4,3,0,0,
0,0,0,0,4,3,1,0),
nrow = 4, ncol = 8)
trial3 <- matrix(data = c(1,1,1,0,4,5,0,0,
1,0,1,0,0,7,0,0,
0,1,1,0,4,3,0,0,
0,1,0,0,4,3,1,0),
nrow= 4, ncol = 8)
weights <- c(-20,-11,-8,-28,-9,-3,-3,-40)
trial3p <- sweep(trial3, MARGIN = 2, weights, "*")
trial2 <- sweep(trial, MARGIN = 2, weights, "*")
trial3p
trial3 <- matrix(data = c(1,1,1,0,4,5,0,0,
1,0,1,0,0,7,0,0,
0,1,1,0,4,3,0,0,
0,1,0,0,4,3,1,0),
nrow= 4, ncol = 8)
trial3
View(trial3)
?matrix
trial <- matrix(data = c(1,0,1,0,4,5,0,0,
1,0,1,0,0,7,0,0,
0,0,1,0,4,3,0,0,
0,0,0,0,4,3,1,0),
nrow = 4, ncol = 8, byrow = T)
View(trial)
trial <- matrix(data = c(1,0,1,0,4,5,0,0,
1,0,1,0,0,7,0,0,
0,0,1,0,4,3,0,0,
0,0,0,0,4,3,1,0),
nrow = 4, ncol = 8, byrow = T)
trial3 <- matrix(data = c(1,1,1,0,4,5,0,0,
1,0,1,0,0,7,0,0,
0,1,1,0,4,3,0,0,
0,1,0,0,4,3,1,0),
nrow= 4, ncol = 8, byrow = T)
weights <- c(-20,-11,-8,-28,-9,-3,-3,-40)
trial3p <- sweep(trial3, MARGIN = 2, weights, "*") %>% rowSums() %>% exp()
trial2 <- sweep(trial, MARGIN = 2, weights, "*") %>% rowSums() %>% exp()
trial2[1] / (trial2[1] + trial2[2] + trial2[3] + trial2[4])
trial2[2] / (trial2[1] + trial2[2] + trial2[3] + trial2[4])
trial2[3] / (trial2[1] + trial2[2] + trial2[3] + trial2[4])
trial2[4] / (trial2[1] + trial2[2] + trial2[3] + trial2[4])
trial3p[1] / (trial3p[1] + trial3p[2] + trial3p[3] + trial3p[4])
trial3p[2] / (trial3p[1] + trial3p[2] + trial3p[3] + trial3p[4])
trial3p[3] / (trial3p[1] + trial3p[2] + trial3p[3] + trial3p[4])
trial3p[4] / (trial3p[1] + trial3p[2] + trial3p[3] + trial3p[4])
